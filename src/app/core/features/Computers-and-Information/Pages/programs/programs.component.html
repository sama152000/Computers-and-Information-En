<!-- Loading State -->
<div class="programs-page" *ngIf="isLoading">
  <div class="container">
    <div class="row">
      <div class="col-lg-4">
        <aside class="sidebar">
          <div class="sidebar-section">
            <p-skeleton width="150px" height="1.5rem" styleClass="mb-3" />
            <p-skeleton width="100%" height="50px" styleClass="mb-2" />
            <p-skeleton width="100%" height="50px" styleClass="mb-2" />
            <p-skeleton width="100%" height="50px" />
          </div>
        </aside>
      </div>
      <div class="col-lg-8">
        <div class="program-content">
          <p-skeleton width="250px" height="2rem" styleClass="mb-4" />
          <p-skeleton width="100%" height="1rem" styleClass="mb-2" />
          <p-skeleton width="100%" height="1rem" styleClass="mb-2" />
          <p-skeleton width="80%" height="1rem" />
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Error State -->
<div class="programs-page" *ngIf="hasError && !isLoading">
  <div class="container">
    <div class="error-container">
      <i class="pi pi-exclamation-triangle error-icon"></i>
      <h2>Failed to load programs</h2>
      <p>Please try again later.</p>
    </div>
  </div>
</div>

<!-- Content State -->
<div class="programs-page" *ngIf="!isLoading && !hasError">
  <div class="container">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-lg-4">
        <aside class="sidebar">
          <div class="sidebar-section" *ngIf="currentProgram">
            <h3 class="sidebar-title">{{ getProgramName(currentProgram) }}</h3>
            <div class="nav-links">
              <button
                class="nav-link-btn"
                *ngFor="let section of programSections"
                [class.active]="currentSection?.id === section.id"
                (click)="selectSection(section)"
              >
                <i [class]="section.icon + ' me-2'"></i>
                {{ section.title }}
              </button>
            </div>
          </div>

          <div class="sidebar-section">
            <h3 class="sidebar-title">Academic Programs</h3>
            <div class="programs-list">
              <button
                class="program-btn"
                *ngFor="let program of allPrograms"
                [class.active]="currentProgram?.id === program.id"
                (click)="selectProgram(program)"
              >
                <div class="program-info">
                  <h5>{{ getProgramName(program) }}</h5>
                </div>
                <i class="pi pi-chevron-right"></i>
              </button>
            </div>
          </div>
        </aside>
      </div>

      <!-- Main Content -->
      <div class="col-lg-8">
        <div class="program-content" *ngIf="currentProgram && currentSection">
          <div class="content-header">
            <h2 class="content-title">
              <i [class]="currentSection.icon + ' me-3'"></i>
              {{ currentSection.title }}
            </h2>
          </div>

          <div class="content-body">
            <!-- About Section -->
            <div *ngIf="currentSection.id === 'about'" class="section-content">
              <div class="featured-image" *ngIf="getFeaturedImage()">
                <img
                  [src]="getFeaturedImage()"
                  [alt]="getProgramName(currentProgram)"
                />
              </div>
              <h3>{{ getProgramName(currentProgram) }}</h3>
              <p class="description">{{ currentProgram.about }}</p>
            </div>

            <!-- Vision & Mission Section -->
            <div *ngIf="currentSection.id === 'vision'" class="section-content">
              <div class="vm-cards">
                <div class="vm-card">
                  <div class="vm-icon"><i class="pi pi-eye"></i></div>
                  <h4>Program Vision</h4>
                  <p>{{ currentProgram.vision || "No vision available." }}</p>
                </div>
                <div class="vm-card">
                  <div class="vm-icon"><i class="pi pi-compass"></i></div>
                  <h4>Program Mission</h4>
                  <p>{{ currentProgram.mission || "No mission available." }}</p>
                </div>
              </div>
            </div>

            <!-- Objectives Section -->
            <div
              *ngIf="currentSection.id === 'objectives'"
              class="section-content"
            >
              <h3>Program Goals & Objectives</h3>
              <div class="objectives-grid" *ngIf="currentProgram.goals?.length">
                <div
                  class="objective-card"
                  *ngFor="let goal of currentProgram.goals"
                >
                  <div class="goal-number">{{ goal.index }}</div>
                  <p>{{ goal.goalName }}</p>
                </div>
              </div>
              <p *ngIf="!currentProgram.goals?.length" class="text-muted">
                No objectives available.
              </p>
            </div>

            <!-- Details Section -->
            <div
              *ngIf="currentSection.id === 'details'"
              class="section-content"
            >
              <h3>Program Details</h3>
              <div class="details-list" *ngIf="programDetails.length > 0">
                <div class="detail-item" *ngFor="let detail of programDetails">
                  <h4>{{ detail.title }}</h4>
                  <p class="category-badge" *ngIf="detail.programCategory">
                    {{ detail.programCategory }}
                  </p>
                  <p class="detail-content">{{ detail.content }}</p>
                </div>
              </div>
              <p *ngIf="programDetails.length === 0" class="text-muted">
                No details available.
              </p>
            </div>

            <!-- Staff Section -->
            <div *ngIf="currentSection.id === 'staff'" class="section-content">
              <h3>Program Staff</h3>

              <!-- Program Leader -->
              <div class="leader-section" *ngIf="programLeader">
                <h4>Program Coordinator</h4>
                <div class="leader-card">
                  <div class="leader-avatar">
                    <i class="pi pi-user"></i>
                  </div>
                  <div class="leader-info">
                    <h5>{{ programLeader.memberName }}</h5>
                    <span class="badge">Program Coordinator</span>
                  </div>
                </div>
              </div>

              <!-- Staff Members -->
              <div class="members-section" *ngIf="programMembers.length > 0">
                <h4>Staff Members</h4>
                <div class="members-grid">
                  <div
                    class="member-card"
                    *ngFor="let member of programMembers"
                    [class.leader]="member.isLeader"
                  >
                    <div class="member-avatar">
                      <i class="pi pi-user"></i>
                    </div>
                    <div class="member-info">
                      <h5>{{ member.memberName }}</h5>
                      <span class="badge" *ngIf="member.isLeader"
                        >Coordinator</span
                      >
                    </div>
                  </div>
                </div>
              </div>

              <p *ngIf="programMembers.length === 0" class="text-muted">
                No staff members available.
              </p>
            </div>
          </div>
        </div>

        <!-- Default View -->
        <div class="default-content" *ngIf="!currentProgram">
          <div class="welcome-section">
            <h2>Academic Programs</h2>
            <p>
              Select a program to explore its curriculum, objectives, and
              coordinator information.
            </p>
            <div class="programs-grid">
              <div
                class="program-card"
                *ngFor="let program of allPrograms"
                (click)="selectProgram(program)"
              >
                <div
                  class="program-image"
                  *ngIf="program.programAttachments?.length"
                >
                  <img
                    [src]="program.programAttachments[0].url"
                    [alt]="getProgramName(program)"
                  />
                </div>
                <div
                  class="program-icon"
                  *ngIf="!program.programAttachments?.length"
                >
                  <i class="pi pi-book"></i>
                </div>
                <h4>{{ getProgramName(program) }}</h4>
                <span class="learn-more">
                  Explore Program <i class="pi pi-arrow-right"></i>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>
