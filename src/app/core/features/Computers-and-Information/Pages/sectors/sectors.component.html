<!-- Loading State -->
<div class="sectors-page" *ngIf="isLoading">
  <div class="container">
    <div class="row">
      <div class="col-lg-4">
        <aside class="sidebar">
          <div class="sidebar-section">
            <p-skeleton width="150px" height="1.5rem" styleClass="mb-3" />
            <p-skeleton width="100%" height="40px" styleClass="mb-2" />
            <p-skeleton width="100%" height="40px" styleClass="mb-2" />
            <p-skeleton width="100%" height="40px" />
          </div>
        </aside>
      </div>
      <div class="col-lg-8">
        <div class="sector-content">
          <p-skeleton width="200px" height="2rem" styleClass="mb-4" />
          <p-skeleton width="100%" height="1rem" styleClass="mb-2" />
          <p-skeleton width="100%" height="1rem" styleClass="mb-2" />
          <p-skeleton width="80%" height="1rem" />
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Error State -->
<div class="sectors-page" *ngIf="hasError && !isLoading">
  <div class="container">
    <div class="error-container">
      <i class="pi pi-exclamation-triangle error-icon"></i>
      <h2>Failed to load sectors</h2>
      <p>Please try again later.</p>
    </div>
  </div>
</div>

<!-- Content State -->
<div class="sectors-page" *ngIf="!isLoading && !hasError">
  <div class="container">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-lg-4">
        <aside class="sidebar">
          <div class="sidebar-section" *ngIf="currentSector">
            <h3 class="sidebar-title">{{ currentSector.name }}</h3>
            <div class="nav-links">
              <button
                class="nav-link-btn"
                *ngFor="let section of sectorSections"
                [class.active]="currentSection?.id === section.id"
                (click)="selectSection(section)"
              >
                <i [class]="section.icon + ' me-2'"></i>
                {{ section.title }}
              </button>
            </div>
          </div>

          <div class="sidebar-section">
            <h3 class="sidebar-title">Scientific Sections</h3>
            <div class="sectors-list">
              <button
                class="sector-btn"
                *ngFor="let sector of allSectors"
                [class.active]="currentSector?.id === sector.id"
                (click)="selectSector(sector)"
              >
                <div class="sector-info">
                  <h5>{{ sector.name }}</h5>
                  <small *ngIf="sector.subTitle">{{ sector.subTitle }}</small>
                </div>
                <i class="pi pi-chevron-right"></i>
              </button>
            </div>
          </div>
        </aside>
      </div>

      <!-- Main Content -->
      <div class="col-lg-8">
        <div class="sector-content" *ngIf="currentSector && currentSection">
          <div class="content-header">
            <h2 class="content-title">
              <i [class]="currentSection.icon + ' me-3'"></i>
              {{ currentSection.title }}
            </h2>
          </div>

          <div class="content-body">
            <!-- About Section -->
            <div *ngIf="currentSection.id === 'about'" class="section-content">
              <div class="featured-image" *ngIf="getFeaturedImage()">
                <img [src]="getFeaturedImage()" [alt]="currentSector.name" />
              </div>
              <h3>{{ currentSector.name }}</h3>
              <p class="subtitle" *ngIf="currentSector.subTitle">
                {{ currentSector.subTitle }}
              </p>
              <p class="description">{{ currentSector.about }}</p>
            </div>

            <!-- Vision & Mission Section -->
            <div *ngIf="currentSection.id === 'vision'" class="section-content">
              <div class="vm-card vision-card">
                <div class="vm-icon"><i class="pi pi-eye"></i></div>
                <h4>Section Vision</h4>
                <p>
                  {{ currentSector.vision || "No vision available." }}
                </p>
              </div>
              <div class="vm-card mission-card">
                <div class="vm-icon"><i class="pi pi-compass"></i></div>
                <h4>Section Mission</h4>
                <p>
                  {{ currentSector.mission || "No mission available." }}
                </p>
              </div>
            </div>

            <!-- Objectives Section -->
            <div
              *ngIf="currentSection.id === 'objectives'"
              class="section-content"
            >
              <h3>Section Goals & Objectives</h3>
              <div
                class="objectives-grid"
                *ngIf="currentSector.goals && currentSector.goals.length > 0"
              >
                <div
                  class="objective-card"
                  *ngFor="let goal of currentSector.goals"
                >
                  <div class="goal-number">{{ goal.index }}</div>
                  <p>{{ goal.goalName }}</p>
                </div>
              </div>
              <p
                *ngIf="!currentSector.goals || currentSector.goals.length === 0"
                class="text-muted"
              >
                No objectives available.
              </p>
            </div>

            <!-- Programs Section -->
            <div
              *ngIf="currentSection.id === 'programs'"
              class="section-content"
            >
              <h3>Academic Programs</h3>
              <div class="programs-list" *ngIf="sectorPrograms.length > 0">
                <div class="program-card" *ngFor="let prog of sectorPrograms">
                  <i class="pi pi-graduation-cap"></i>
                  <div class="program-info">
                    <h5>{{ prog.programName }}</h5>
                  </div>
                </div>
              </div>
              <p *ngIf="sectorPrograms.length === 0" class="text-muted">
                No programs available.
              </p>
            </div>

            <!-- Staff Section -->
            <div *ngIf="currentSection.id === 'staff'" class="section-content">
              <h3>Staff Members</h3>

              <!-- Section Leader -->
              <div class="leader-card" *ngIf="sectorLeader">
                <h4>Section Leader</h4>
                <div class="member-card leader">
                  <i class="pi pi-user"></i>
                  <div class="member-info">
                    <h5>{{ sectorLeader.memberName }}</h5>
                    <span class="badge">Leader</span>
                  </div>
                </div>
              </div>

              <!-- Other Members -->
              <div class="members-grid" *ngIf="sectorMembers.length > 0">
                <div
                  class="member-card"
                  *ngFor="let member of sectorMembers"
                  [class.leader]="member.isLeader"
                >
                  <i class="pi pi-user"></i>
                  <div class="member-info">
                    <h5>{{ member.memberName }}</h5>
                    <span class="badge" *ngIf="member.isLeader">Leader</span>
                  </div>
                </div>
              </div>
              <p *ngIf="sectorMembers.length === 0" class="text-muted">
                No staff members available.
              </p>
            </div>

            <!-- Details Section -->
            <div
              *ngIf="currentSection.id === 'details'"
              class="section-content"
            >
              <h3>Additional Details</h3>
              <div class="details-list" *ngIf="sectorDetails.length > 0">
                <div class="detail-card" *ngFor="let detail of sectorDetails">
                  <h4>{{ detail.title }}</h4>
                  <p>{{ detail.content }}</p>
                </div>
              </div>
              <p *ngIf="sectorDetails.length === 0" class="text-muted">
                No additional details available.
              </p>
            </div>
          </div>
        </div>

        <!-- Default View -->
        <div class="default-content" *ngIf="!currentSector">
          <h2>Scientific Sections of the Faculty</h2>
          <p>
            Choose a section from the list to view its full details, programs,
            scientific research, and faculty members.
          </p>
          <div class="sectors-grid">
            <div
              class="sector-card"
              *ngFor="let sector of allSectors"
              (click)="selectSector(sector)"
            >
              <div
                class="sector-card-image"
                *ngIf="
                  sector.sectorAttachments &&
                  sector.sectorAttachments.length > 0
                "
              >
                <img
                  [src]="sector.sectorAttachments[0].url"
                  [alt]="sector.name"
                />
              </div>
              <div class="sector-card-content">
                <h4>{{ sector.name }}</h4>
                <p *ngIf="sector.subTitle">{{ sector.subTitle }}</p>
                <span class="learn-more"
                  >View Details <i class="pi pi-arrow-right"></i
                ></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
